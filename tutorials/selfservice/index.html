<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Self-Service Data Analytic · GeneralLedger.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="GeneralLedger.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeneralLedger.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Objective</a></li><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../aboutgl/">About GL</a></li><li><a class="tocitem" href="../glprocesses/">GL Processes</a></li><li><a class="tocitem" href="../erd/">ERD</a></li><li><a class="tocitem" href="../installation/">Installing Julia</a></li><li><a class="tocitem" href="../elt/">ELT vs ETL</a></li><li class="is-active"><a class="tocitem" href>Self-Service Data Analytic</a><ul class="internal"><li><a class="tocitem" href="#About-ERP-Systems,-General-Ledger-and-Supply-chain"><span>About ERP Systems, General Ledger &amp; Supply chain</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#Finance-Ledger-,-Balance-Sheet,-Income-Statement-and-Cash-Flow"><span>Finance Ledger , Balance Sheet, Income Statement and Cash Flow</span></a></li></ul></li><li><a class="tocitem" href="../plots/">Visualizations, Buttons, sliders, filters, n-D plots, plots vs graphs</a></li><li><a class="tocitem" href="../analytic/">p-value, null hypothesis and real time analytic</a></li><li><a class="tocitem" href="../timeseries/">Time Series, Impact analysis</a></li><li><a class="tocitem" href="../mlforgl/">ML for GL</a></li><li><a class="tocitem" href="../nlp/">NLP for GL</a></li><li><a class="tocitem" href="../graph/">Graph Theory / Network Science</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Self-Service Data Analytic</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Self-Service Data Analytic</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/AmitXShukla/GeneralLedger.jl/blob/master/docs/src/tutorials/selfservice.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Self-Service-Analytics"><a class="docs-heading-anchor" href="#Self-Service-Analytics">Self Service Analytics</a><a id="Self-Service-Analytics-1"></a><a class="docs-heading-anchor-permalink" href="#Self-Service-Analytics" title="Permalink"></a></h1><p>In the previous chapter, we learned how to extract, load and transform data. Often, ERP system use RDBMS database to store data in normalized forms. However, recently, due to advancements in cloud computing, ELT Data lakes gained popularity to perform data analysis, high performance parallel computing in cloud environments.</p><p>In this chapter, we will learn how to create self-service normalized data for ad-hoc reporting using The Julia Language. We will create sample data to mimic actuals datasets and will further create basic GL reports using this data.</p><p>This tpye of drag &#39;n&#39; drop ad-hoc analytics reporting is very popular using BI tools like Microsoft Power BI, Tableau, Kibana, OACs, Cognos etc.</p><p>Creating these basic reports in Julia language may not look very useful in the beginning. This exercise should be seen as creating fundamental environment for reporting, which helps perform Advance Analytics, Real time analytics, Advance Visualizations and Predictive analytics on Financial data later on.</p><h2 id="About-ERP-Systems,-General-Ledger-and-Supply-chain"><a class="docs-heading-anchor" href="#About-ERP-Systems,-General-Ledger-and-Supply-chain">About ERP Systems, General Ledger &amp; Supply chain</a><a id="About-ERP-Systems,-General-Ledger-and-Supply-chain-1"></a><a class="docs-heading-anchor-permalink" href="#About-ERP-Systems,-General-Ledger-and-Supply-chain" title="Permalink"></a></h2><p>A typical ERP system consists of many modules based on business domain, functions and operations.</p><p>GL is core of Finance and Supply chain domains and Buy to Pay, Order to Cash deal with different aspects of business operations in an Organization. Many organization, use ERPs in different ways and may chose to implement all or some of the modules.</p><p>You can find examples of module specific business operations/processes diagram here.</p><ul><li><a href="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/gl.png">General Ledger process flow</a></li><li><a href="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/ap.png">Account Payable process flow</a></li><li><a href="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/tax.png">Tax Analytics</a></li><li><a href="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/gl_erd.png">Sample GL ERD - Entity Relaton Diagram</a></li></ul><p>A typical ERP modules list looks like below diagram.</p><p><img src="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/ERP_modules.png" alt="ERP Modules"/></p><h4 id="Current-Solutions"><a class="docs-heading-anchor" href="#Current-Solutions">Current Solutions</a><a id="Current-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Current-Solutions" title="Permalink"></a></h4><p>Big Organizations have been using big ERP systems like <strong>SAP, Oracle, PeopleSoft, Coupa, Workday</strong> etc. systems over few decades now and  Recent popularity of softwares like <strong>Quickbooks, NetSuite, Tally</strong> in medium, small organizations are proof that ERP are the way to manage any business successfully.</p><p>Finance analysts, supply chain managers heavily rely on using Business Intelligence tools like <strong>Microsoft Excel, Microsoft Power BI, Tableau, Oracle Analytics, Google Analytics, IBM Cognos, Business Objects</strong> etc. </p><p>These BI tools provide a self-service reporting for analytics and often are used for managing daily ad-hoc reporting and anlysis.</p><p>A typical ERP data flow process looks like below diagram.</p><p><img src="https://github.com/AmitXShukla/AmitXShukla.github.io/raw/master/blogs/PlutoCon/gl.png" alt="GL Processes"/></p><h4 id="Problem-Statement"><a class="docs-heading-anchor" href="#Problem-Statement">Problem Statement</a><a id="Problem-Statement-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Statement" title="Permalink"></a></h4><p><em>&quot;Read, Write and Understand&quot;</em> data are three aspects of any ERP system.</p><p>While big and small ERPs master &quot;write aspect&quot; of ERP, there is lot needs to be done on &quot;read &amp; understand&quot; data.</p><p>I would rather not waste your time talking about how one BI Tools compare with Pluto  or others, </p><p>instead, in this chapter, I will show some sample reports I built in Pluto last year for Pandemic reporting, and then let Analysts decide, if They would have rather used Traditional BI reportings tools to build these reports.</p><p>Point is, How easily, Pluto can create real time ad-hoc, <em>Reactive</em> dashboard analytics to support critical business operations.</p><h4 id="understanding-Finance,-Supply-chain-data"><a class="docs-heading-anchor" href="#understanding-Finance,-Supply-chain-data">understanding Finance, Supply chain data</a><a id="understanding-Finance,-Supply-chain-data-1"></a><a class="docs-heading-anchor-permalink" href="#understanding-Finance,-Supply-chain-data" title="Permalink"></a></h4><p>A typical Finance statement look like this. <a href="https://s2.q4cdn.com/470004039/files/doc_financials/2020/q4/FY20_Q4_Consolidated_Financial_Statements.pdf">click here</a></p><p>Let&#39;s first create chartfields to support General Ledger finance books accounting structure, this accounting structure will support Ledger Analytics and should be interpreted as data structure responsilbe to create Finance Statements.</p><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>below are sample data sets,</p><p>Accounts, Dept (or Cost Center), Location, and Finance Ledger may look like below examples.</p><p>Let&#39;s first activate GeneralLedger.jl package.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # Let&#39;s first import GeneralLedger.jl package
       # in following examples, I&#39;ll assume, that you downloaded this package
       using Pkg</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Pkg.add(url=&quot;https://github.com/AmitXShukla/GeneralLedger.jl&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">    Updating git-repo `https://github.com/AmitXShukla/GeneralLedger.jl`
ERROR: package `GeneralLedger [640f5719]` has same name or UUID as the active project</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using GeneralLedger</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h4 id="Accounts-Dimension"><a class="docs-heading-anchor" href="#Accounts-Dimension">Accounts Dimension</a><a id="Accounts-Dimension-1"></a><a class="docs-heading-anchor-permalink" href="#Accounts-Dimension" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames, Dates</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create dummy data
       accounts = DataFrame(AS_OF_DATE=Date(&quot;1900-01-01&quot;, dateformat&quot;y-m-d&quot;),
       					ID = 11000:1000:45000,
       					CLASSIFICATION=repeat([
       		&quot;OPERATING_EXPENSES&quot;,&quot;NON-OPERATING_EXPENSES&quot;, &quot;ASSETS&quot;,&quot;LIABILITIES&quot;,
       		&quot;NET_WORTH&quot;,&quot;STATISTICS&quot;,&quot;REVENUE&quot;
       		], inner=5),
       	CATEGORY=[
       		&quot;Travel&quot;,&quot;Payroll&quot;,&quot;non-Payroll&quot;,&quot;Allowance&quot;,&quot;Cash&quot;,
       		&quot;Facility&quot;,&quot;Supply&quot;,&quot;Services&quot;,&quot;Investment&quot;,&quot;Misc.&quot;,
       		&quot;Depreciation&quot;,&quot;Gain&quot;,&quot;Service&quot;,&quot;Retired&quot;,&quot;Fault.&quot;,
       		&quot;Receipt&quot;,&quot;Accrual&quot;,&quot;Return&quot;,&quot;Credit&quot;,&quot;ROI&quot;,
       		&quot;Cash&quot;,&quot;Funds&quot;,&quot;Invest&quot;,&quot;Transfer&quot;,&quot;Roll-over&quot;,
       		&quot;FTE&quot;,&quot;Members&quot;,&quot;Non_Members&quot;,&quot;Temp&quot;,&quot;Contractors&quot;,
       		&quot;Sales&quot;,&quot;Merchant&quot;,&quot;Service&quot;,&quot;Consulting&quot;,&quot;Subscriptions&quot;
       	],
       	STATUS=&quot;A&quot;,
       	DESCR=repeat([
       		&quot;operating expenses&quot;,&quot;non-operating expenses&quot;,
       		&quot;assets&quot;,&quot;liability&quot;,&quot;net-worth&quot;,&quot;stats&quot;,&quot;revenue&quot;
       	], inner=5),
       	ACCOUNT_TYPE=repeat([
       	&quot;E&quot;,&quot;E&quot;,&quot;A&quot;,&quot;L&quot;,&quot;N&quot;,&quot;S&quot;,&quot;R&quot;
       				],inner=5));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; accounts[collect(1:5:35),:]</code><code class="nohighlight hljs ansi" style="display:block;">7×7 DataFrame
 Row │ AS_OF_DATE  ID     CLASSIFICATION          CATEGORY      STATUS  DESCR  ⋯
     │ Dates.Date  Int64  String                  String        String  String ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 1900-01-01  11000  OPERATING_EXPENSES      Travel        A       operat ⋯
   2 │ 1900-01-01  16000  NON-OPERATING_EXPENSES  Facility      A       non-op
   3 │ 1900-01-01  21000  ASSETS                  Depreciation  A       assets
   4 │ 1900-01-01  26000  LIABILITIES             Receipt       A       liabil
   5 │ 1900-01-01  31000  NET_WORTH               Cash          A       net-wo ⋯
   6 │ 1900-01-01  36000  STATISTICS              FTE           A       stats
   7 │ 1900-01-01  41000  REVENUE                 Sales         A       revenu
                                                               2 columns omitted</code></pre><h4 id="Department-Dimension"><a class="docs-heading-anchor" href="#Department-Dimension">Department Dimension</a><a id="Department-Dimension-1"></a><a class="docs-heading-anchor-permalink" href="#Department-Dimension" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames, Dates</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create dummy data
       dept = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 1100:100:1500,
       							CLASSIFICATION=[
       	&quot;SALES&quot;,&quot;HR&quot;, &quot;IT&quot;,&quot;BUSINESS&quot;,&quot;OTHERS&quot;
       	],
       							CATEGORY=[
       	&quot;sales&quot;,&quot;human_resource&quot;,&quot;IT_Staff&quot;,&quot;business&quot;,&quot;others&quot;
       	],
       							STATUS=&quot;A&quot;,
       							DESCR=[
       	&quot;Sales &amp; Marketing&quot;,&quot;Human Resource&quot;,&quot;Infomration Technology&quot;,&quot;Business leaders&quot;,&quot;other temp&quot;
       	],
       							DEPT_TYPE=[
       	&quot;S&quot;,&quot;H&quot;,&quot;I&quot;,&quot;B&quot;,&quot;O&quot;]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dept[collect(1:5),:]</code><code class="nohighlight hljs ansi" style="display:block;">5×7 DataFrame
 Row │ AS_OF_DATE  ID     CLASSIFICATION  CATEGORY        STATUS  DESCR        ⋯
     │ Dates.Date  Int64  String          String          String  String       ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2000-01-01   1100  SALES           sales           A       Sales &amp; Mark ⋯
   2 │ 2000-01-01   1200  HR              human_resource  A       Human Resour
   3 │ 2000-01-01   1300  IT              IT_Staff        A       Infomration
   4 │ 2000-01-01   1400  BUSINESS        business        A       Business lea
   5 │ 2000-01-01   1500  OTHERS          others          A       other temp   ⋯
                                                               2 columns omitted</code></pre><h4 id="Location-Dimension"><a class="docs-heading-anchor" href="#Location-Dimension">Location Dimension</a><a id="Location-Dimension-1"></a><a class="docs-heading-anchor-permalink" href="#Location-Dimension" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames, Dates</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create dummy data
       location = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 11:1:22,
       							CLASSIFICATION=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							CATEGORY=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							STATUS=&quot;A&quot;,
       							DESCR=[
       &quot;Boston&quot;,&quot;New York&quot;,&quot;Philadelphia&quot;,&quot;Cleveland&quot;,&quot;Richmond&quot;,
       &quot;Atlanta&quot;,&quot;Chicago&quot;,&quot;St. Louis&quot;,&quot;Minneapolis&quot;,&quot;Kansas City&quot;,
       &quot;Dallas&quot;,&quot;San Francisco&quot;],
       							LOCA_TYPE=&quot;Physical&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; location[:,:]</code><code class="nohighlight hljs ansi" style="display:block;">12×7 DataFrame
 Row │ AS_OF_DATE  ID     CLASSIFICATION  CATEGORY  STATUS  DESCR          LOC ⋯
     │ Dates.Date  Int64  String          String    String  String         Str ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ 2000-01-01     11  Region A        Region A  A       Boston         Phy ⋯
   2 │ 2000-01-01     12  Region A        Region A  A       New York       Phy
   3 │ 2000-01-01     13  Region A        Region A  A       Philadelphia   Phy
   4 │ 2000-01-01     14  Region A        Region A  A       Cleveland      Phy
   5 │ 2000-01-01     15  Region B        Region B  A       Richmond       Phy ⋯
   6 │ 2000-01-01     16  Region B        Region B  A       Atlanta        Phy
   7 │ 2000-01-01     17  Region B        Region B  A       Chicago        Phy
   8 │ 2000-01-01     18  Region B        Region B  A       St. Louis      Phy
   9 │ 2000-01-01     19  Region C        Region C  A       Minneapolis    Phy ⋯
  10 │ 2000-01-01     20  Region C        Region C  A       Kansas City    Phy
  11 │ 2000-01-01     21  Region C        Region C  A       Dallas         Phy
  12 │ 2000-01-01     22  Region C        Region C  A       San Francisco  Phy
                                                                1 column omitted</code></pre><h4 id="visuals"><a class="docs-heading-anchor" href="#visuals">visuals</a><a id="visuals-1"></a><a class="docs-heading-anchor-permalink" href="#visuals" title="Permalink"></a></h4><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames, Plots, Dates</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create dummy data
       accounts = DataFrame(AS_OF_DATE=Date(&quot;1900-01-01&quot;, dateformat&quot;y-m-d&quot;),
       					ID = 11000:1000:45000,
       					CLASSIFICATION=repeat([
       		&quot;OPERATING_EXPENSES&quot;,&quot;NON-OPERATING_EXPENSES&quot;, &quot;ASSETS&quot;,&quot;LIABILITIES&quot;,
       		&quot;NET_WORTH&quot;,&quot;STATISTICS&quot;,&quot;REVENUE&quot;
       		], inner=5),
       	CATEGORY=[
       		&quot;Travel&quot;,&quot;Payroll&quot;,&quot;non-Payroll&quot;,&quot;Allowance&quot;,&quot;Cash&quot;,
       		&quot;Facility&quot;,&quot;Supply&quot;,&quot;Services&quot;,&quot;Investment&quot;,&quot;Misc.&quot;,
       		&quot;Depreciation&quot;,&quot;Gain&quot;,&quot;Service&quot;,&quot;Retired&quot;,&quot;Fault.&quot;,
       		&quot;Receipt&quot;,&quot;Accrual&quot;,&quot;Return&quot;,&quot;Credit&quot;,&quot;ROI&quot;,
       		&quot;Cash&quot;,&quot;Funds&quot;,&quot;Invest&quot;,&quot;Transfer&quot;,&quot;Roll-over&quot;,
       		&quot;FTE&quot;,&quot;Members&quot;,&quot;Non_Members&quot;,&quot;Temp&quot;,&quot;Contractors&quot;,
       		&quot;Sales&quot;,&quot;Merchant&quot;,&quot;Service&quot;,&quot;Consulting&quot;,&quot;Subscriptions&quot;
       	],
       	STATUS=&quot;A&quot;,
       	DESCR=repeat([
       		&quot;operating expenses&quot;,&quot;non-operating expenses&quot;,
       		&quot;assets&quot;,&quot;liability&quot;,&quot;net-worth&quot;,&quot;stats&quot;,&quot;revenue&quot;
       	], inner=5),
       	ACCOUNT_TYPE=repeat([
       	&quot;E&quot;,&quot;E&quot;,&quot;A&quot;,&quot;L&quot;,&quot;N&quot;,&quot;S&quot;,&quot;R&quot;
       				],inner=5));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dept = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 1100:100:1500,
       							CLASSIFICATION=[
       	&quot;SALES&quot;,&quot;HR&quot;, &quot;IT&quot;,&quot;BUSINESS&quot;,&quot;OTHERS&quot;
       	],
       							CATEGORY=[
       	&quot;sales&quot;,&quot;human_resource&quot;,&quot;IT_Staff&quot;,&quot;business&quot;,&quot;others&quot;
       	],
       							STATUS=&quot;A&quot;,
       							DESCR=[
       	&quot;Sales &amp; Marketing&quot;,&quot;Human Resource&quot;,&quot;Infomration Technology&quot;,&quot;Business leaders&quot;,&quot;other temp&quot;
       	],
       							DEPT_TYPE=[
       	&quot;S&quot;,&quot;H&quot;,&quot;I&quot;,&quot;B&quot;,&quot;O&quot;]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; location = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 11:1:22,
       							CLASSIFICATION=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							CATEGORY=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							STATUS=&quot;A&quot;,
       							DESCR=[
       &quot;Boston&quot;,&quot;New York&quot;,&quot;Philadelphia&quot;,&quot;Cleveland&quot;,&quot;Richmond&quot;,
       &quot;Atlanta&quot;,&quot;Chicago&quot;,&quot;St. Louis&quot;,&quot;Minneapolis&quot;,&quot;Kansas City&quot;,
       &quot;Dallas&quot;,&quot;San Francisco&quot;],
       							LOCA_TYPE=&quot;Physical&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; p1 = plot((combine(groupby(accounts, :CLASSIFICATION), nrow)).nrow,(combine(groupby(accounts, :CLASSIFICATION), nrow)).CLASSIFICATION, seriestype=scatter, label = &quot;# of accounts by classification&quot;, xlabel = &quot;# of accounts&quot;, ylabel=&quot;Class&quot;, xlims = (0, 5.5))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	p2 = plot((combine(groupby(dept, :CLASSIFICATION), nrow)).nrow,(combine(groupby(dept, :CLASSIFICATION), nrow)).CLASSIFICATION, seriestype=scatter, label = &quot;# of dept by classification&quot;, xlabel = &quot;# of depts&quot;, ylabel=&quot;Class&quot;, xlims = (0, 2))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	p3 = plot((combine(groupby(accounts, :CLASSIFICATION), nrow)).nrow,(combine(groupby(location, :CLASSIFICATION), nrow)).CLASSIFICATION, seriestype=scatter, label = &quot;# of locations by classification&quot;, xlabel = &quot;# of locations&quot;, ylabel=&quot;Class&quot;, xlims = (1, 6.5))</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=1}</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; plot(p1, p2, p3, layout = (3, 1), legend = false)</code><code class="nohighlight hljs ansi" style="display:block;">Plot{Plots.GRBackend() n=3}</code></pre><h2 id="Finance-Ledger-,-Balance-Sheet,-Income-Statement-and-Cash-Flow"><a class="docs-heading-anchor" href="#Finance-Ledger-,-Balance-Sheet,-Income-Statement-and-Cash-Flow">Finance Ledger , Balance Sheet, Income Statement and Cash Flow</a><a id="Finance-Ledger-,-Balance-Sheet,-Income-Statement-and-Cash-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Finance-Ledger-,-Balance-Sheet,-Income-Statement-and-Cash-Flow" title="Permalink"></a></h2><p>below is sample Finance Ledger Data</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFrames, Plots, Dates</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create dummy data
       accounts = DataFrame(AS_OF_DATE=Date(&quot;1900-01-01&quot;, dateformat&quot;y-m-d&quot;),
       					ID = 11000:1000:45000,
       					CLASSIFICATION=repeat([
       		&quot;OPERATING_EXPENSES&quot;,&quot;NON-OPERATING_EXPENSES&quot;, &quot;ASSETS&quot;,&quot;LIABILITIES&quot;,
       		&quot;NET_WORTH&quot;,&quot;STATISTICS&quot;,&quot;REVENUE&quot;
       		], inner=5),
       	CATEGORY=[
       		&quot;Travel&quot;,&quot;Payroll&quot;,&quot;non-Payroll&quot;,&quot;Allowance&quot;,&quot;Cash&quot;,
       		&quot;Facility&quot;,&quot;Supply&quot;,&quot;Services&quot;,&quot;Investment&quot;,&quot;Misc.&quot;,
       		&quot;Depreciation&quot;,&quot;Gain&quot;,&quot;Service&quot;,&quot;Retired&quot;,&quot;Fault.&quot;,
       		&quot;Receipt&quot;,&quot;Accrual&quot;,&quot;Return&quot;,&quot;Credit&quot;,&quot;ROI&quot;,
       		&quot;Cash&quot;,&quot;Funds&quot;,&quot;Invest&quot;,&quot;Transfer&quot;,&quot;Roll-over&quot;,
       		&quot;FTE&quot;,&quot;Members&quot;,&quot;Non_Members&quot;,&quot;Temp&quot;,&quot;Contractors&quot;,
       		&quot;Sales&quot;,&quot;Merchant&quot;,&quot;Service&quot;,&quot;Consulting&quot;,&quot;Subscriptions&quot;
       	],
       	STATUS=&quot;A&quot;,
       	DESCR=repeat([
       		&quot;operating expenses&quot;,&quot;non-operating expenses&quot;,
       		&quot;assets&quot;,&quot;liability&quot;,&quot;net-worth&quot;,&quot;stats&quot;,&quot;revenue&quot;
       	], inner=5),
       	ACCOUNT_TYPE=repeat([
       	&quot;E&quot;,&quot;E&quot;,&quot;A&quot;,&quot;L&quot;,&quot;N&quot;,&quot;S&quot;,&quot;R&quot;
       				],inner=5));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dept = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 1100:100:1500,
       							CLASSIFICATION=[
       	&quot;SALES&quot;,&quot;HR&quot;, &quot;IT&quot;,&quot;BUSINESS&quot;,&quot;OTHERS&quot;
       	],
       							CATEGORY=[
       	&quot;sales&quot;,&quot;human_resource&quot;,&quot;IT_Staff&quot;,&quot;business&quot;,&quot;others&quot;
       	],
       							STATUS=&quot;A&quot;,
       							DESCR=[
       	&quot;Sales &amp; Marketing&quot;,&quot;Human Resource&quot;,&quot;Infomration Technology&quot;,&quot;Business leaders&quot;,&quot;other temp&quot;
       	],
       							DEPT_TYPE=[
       	&quot;S&quot;,&quot;H&quot;,&quot;I&quot;,&quot;B&quot;,&quot;O&quot;]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; location = DataFrame(AS_OF_DATE=Date(&quot;2000-01-01&quot;, dateformat&quot;y-m-d&quot;),
       							ID = 11:1:22,
       							CLASSIFICATION=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							CATEGORY=repeat([
       	&quot;Region A&quot;,&quot;Region B&quot;, &quot;Region C&quot;], inner=4),
       							STATUS=&quot;A&quot;,
       							DESCR=[
       &quot;Boston&quot;,&quot;New York&quot;,&quot;Philadelphia&quot;,&quot;Cleveland&quot;,&quot;Richmond&quot;,
       &quot;Atlanta&quot;,&quot;Chicago&quot;,&quot;St. Louis&quot;,&quot;Minneapolis&quot;,&quot;Kansas City&quot;,
       &quot;Dallas&quot;,&quot;San Francisco&quot;],
       							LOCA_TYPE=&quot;Physical&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ledger = DataFrame(
       		LEDGER = String[], FISCAL_YEAR = Int[], PERIOD = Int[], ORGID = String[],
       		OPER_UNIT = String[], ACCOUNT = Int[], DEPT = Int[], LOCATION = Int[],
       		POSTED_TOTAL = Float64[]
       	);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# create 2020 Period 1-12 Actuals Ledger
       	l = &quot;Actuals&quot;;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	fy = 2020;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	for p = 1:12
       		for i = 1:10^5
       		push!(ledger, (l, fy, p, &quot;ABC Inc.&quot;, rand(location.CATEGORY),
       			rand(accounts.ID), rand(dept.ID), rand(location.ID), rand()*10^8))
       		end
       	end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# create 2021 Period 1-4 Actuals Ledger
       	l = &quot;Actuals&quot;;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	fy = 2021;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	for p = 1:4
       		for i = 1:10^5
       		push!(ledger, (l, fy, p, &quot;ABC Inc.&quot;, rand(location.CATEGORY),
       			rand(accounts.ID), rand(dept.ID), rand(location.ID), rand()*10^8))
       		end
       	end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# create 2021 Period 1-4 Budget Ledger
       	l = &quot;Budget&quot;;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	fy = 2021;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	for p = 1:12
       		for i = 1:10^5
       		push!(ledger, (l, fy, p, &quot;ABC Inc.&quot;, rand(location.CATEGORY),
       			rand(accounts.ID), rand(dept.ID), rand(location.ID), rand()*10^8))
       		end
       	end</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ledger[:,:]</code><code class="nohighlight hljs ansi" style="display:block;">2800000×9 DataFrame
     Row │ LEDGER   FISCAL_YEAR  PERIOD  ORGID     OPER_UNIT  ACCOUNT  DEPT    ⋯
         │ String   Int64        Int64   String    String     Int64    Int64   ⋯
─────────┼──────────────────────────────────────────────────────────────────────
       1 │ Actuals         2020       1  ABC Inc.  Region A     43000   1100   ⋯
       2 │ Actuals         2020       1  ABC Inc.  Region B     25000   1400
       3 │ Actuals         2020       1  ABC Inc.  Region B     16000   1400
       4 │ Actuals         2020       1  ABC Inc.  Region B     34000   1500
       5 │ Actuals         2020       1  ABC Inc.  Region B     28000   1400   ⋯
       6 │ Actuals         2020       1  ABC Inc.  Region C     22000   1400
       7 │ Actuals         2020       1  ABC Inc.  Region C     28000   1400
       8 │ Actuals         2020       1  ABC Inc.  Region B     14000   1100
    ⋮    │    ⋮          ⋮         ⋮        ⋮          ⋮         ⋮       ⋮     ⋱
 2799994 │ Budget          2021      12  ABC Inc.  Region C     19000   1500   ⋯
 2799995 │ Budget          2021      12  ABC Inc.  Region B     18000   1300
 2799996 │ Budget          2021      12  ABC Inc.  Region C     14000   1300
 2799997 │ Budget          2021      12  ABC Inc.  Region C     23000   1400
 2799998 │ Budget          2021      12  ABC Inc.  Region C     44000   1500   ⋯
 2799999 │ Budget          2021      12  ABC Inc.  Region B     31000   1200
 2800000 │ Budget          2021      12  ABC Inc.  Region C     26000   1400
                                              2 columns and 2799985 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create default binding values/params
       using PlutoUI</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ## WARNING
       ## These bind variable will throw in error in documentation
       ## however, these runs fine on Pluto notebooks and provide a slider to change values dynamically
       
       # @bind ld Select([&quot;Actuals&quot;, &quot;Budget&quot;])
       # @bind rg Select([&quot;Region A&quot;, &quot;Region B&quot;, &quot;Region C&quot;])
       # @bind yr Slider(2020:1:2021, default=2020, show_value=true)
       # @bind qtr Slider(1:1:4, default=1, show_value=true)
       # @bind ld_p Select([&quot;Actuals&quot;, &quot;Budget&quot;])
       # @bind yr_p Slider(2020:1:2021, default=2021, show_value=true)
       # @bind rg_p Select([&quot;Region A&quot;, &quot;Region B&quot;, &quot;Region C&quot;])
       # @bind ldescr Select(unique(location.DESCR))
       # @bind adescr Select(unique(accounts.CLASSIFICATION))
       # @bind ddescr Select(unique(dept.CLASSIFICATION))
       
       ld = &quot;Actuals&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;Actuals&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rg = &quot;Region B&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;Region B&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; yr = 2020</code><code class="nohighlight hljs ansi" style="display:block;">2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; qtr = 1</code><code class="nohighlight hljs ansi" style="display:block;">1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ld_p = &quot;Actuals&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;Actuals&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rg_p = &quot;Region B&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;Region B&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; yr_p = 2020</code><code class="nohighlight hljs ansi" style="display:block;">2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; qtr_p = 1</code><code class="nohighlight hljs ansi" style="display:block;">1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ldescr = unique(location.DESCR)</code><code class="nohighlight hljs ansi" style="display:block;">12-element Vector{String}:
 &quot;Boston&quot;
 &quot;New York&quot;
 &quot;Philadelphia&quot;
 &quot;Cleveland&quot;
 &quot;Richmond&quot;
 &quot;Atlanta&quot;
 &quot;Chicago&quot;
 &quot;St. Louis&quot;
 &quot;Minneapolis&quot;
 &quot;Kansas City&quot;
 &quot;Dallas&quot;
 &quot;San Francisco&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; adescr = unique(accounts.CLASSIFICATION)</code><code class="nohighlight hljs ansi" style="display:block;">7-element Vector{String}:
 &quot;OPERATING_EXPENSES&quot;
 &quot;NON-OPERATING_EXPENSES&quot;
 &quot;ASSETS&quot;
 &quot;LIABILITIES&quot;
 &quot;NET_WORTH&quot;
 &quot;STATISTICS&quot;
 &quot;REVENUE&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ddescr = unique(dept.CLASSIFICATION)</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{String}:
 &quot;SALES&quot;
 &quot;HR&quot;
 &quot;IT&quot;
 &quot;BUSINESS&quot;
 &quot;OTHERS&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ########################
       ##### BALANCE SHEET ####
       ########################
       
       # rename dimensions columns for innerjoin
       df_accounts = rename(accounts, :ID =&gt; :ACCOUNTS_ID, :CLASSIFICATION =&gt; :ACCOUNTS_CLASSIFICATION, :CATEGORY =&gt; :ACCOUNTS_CATEGORY, :DESCR =&gt; :ACCOUNTS_DESCR);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df_dept = rename(dept, :ID =&gt; :DEPT_ID, :CLASSIFICATION =&gt; :DEPT_CLASSIFICATION, :CATEGORY =&gt; :DEPT_CATEGORY, :DESCR =&gt; :DEPT_DESCR);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df_location = rename(location, :ID =&gt; :LOCATION_ID, :CLASSIFICATION =&gt; :LOCATION_CLASSIFICATION, :CATEGORY =&gt; :LOCATION_CATEGORY, :DESCR =&gt; :LOCATION_DESCR);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # create a function which converts accounting period to Quarter
       function periodToQtr(x)
       	if x ∈ 1:3
       		return 1
       	elseif x ∈ 4:6
       		return 2
       	elseif x ∈ 7:9
       		return 3
       	else return 4
       	end
       	end</code><code class="nohighlight hljs ansi" style="display:block;">periodToQtr (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ##############################################################
       # create a new dataframe to join all chartfields with ledger #
       ##############################################################
       
       df_ledger = innerjoin(
       		innerjoin(
       			innerjoin(ledger, df_accounts, on = [:ACCOUNT =&gt; :ACCOUNTS_ID], makeunique=true),
       			df_dept, on = [:DEPT =&gt; :DEPT_ID], makeunique=true), df_location,
       	on = [:LOCATION =&gt; :LOCATION_ID], makeunique=true);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	transform!(df_ledger, :PERIOD =&gt; ByRow(periodToQtr) =&gt; :QTR);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; function numToCurrency(x)
       		return string(&quot;USD &quot;,round(x/10^6; digits = 2), &quot;m&quot;)
       	end</code><code class="nohighlight hljs ansi" style="display:block;">numToCurrency (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	gdf = groupby(df_ledger, [:LEDGER, :FISCAL_YEAR, :QTR, :OPER_UNIT, :ACCOUNTS_CLASSIFICATION, :DEPT_CLASSIFICATION,
       			# :LOCATION_CLASSIFICATION,
       			:LOCATION_DESCR]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	gdf_plot = combine(gdf, :POSTED_TOTAL =&gt; sum =&gt; :TOTAL);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	select(gdf_plot[(
       				(gdf_plot.FISCAL_YEAR .== yr)
       				.&amp;
       				(gdf_plot.QTR .== qtr)
       				.&amp;
       				(gdf_plot.LEDGER .== ld)
       				.&amp;
       				(gdf_plot.OPER_UNIT .== rg)
       				),:],
       		:FISCAL_YEAR =&gt; :FY,
       		:QTR =&gt; :Qtr,
       		:OPER_UNIT =&gt; :Org,
       		:ACCOUNTS_CLASSIFICATION =&gt; :Accounts,
       		:DEPT_CLASSIFICATION =&gt; :Dept,
       		# :LOCATION_CLASSIFICATION =&gt; :Region,
       		:LOCATION_DESCR =&gt; :Loc,
       		:TOTAL =&gt; ByRow(numToCurrency) =&gt; :TOTAL)</code><code class="nohighlight hljs ansi" style="display:block;">420×7 DataFrame
 Row │ FY     Qtr    Org       Accounts                Dept      Loc           ⋯
     │ Int64  Int64  String    String                  String    String        ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2020      1  Region B  ASSETS                  BUSINESS  Chicago       ⋯
   2 │  2020      1  Region B  NON-OPERATING_EXPENSES  BUSINESS  St. Louis
   3 │  2020      1  Region B  NET_WORTH               OTHERS    Philadelphia
   4 │  2020      1  Region B  LIABILITIES             BUSINESS  New York
   5 │  2020      1  Region B  OPERATING_EXPENSES      SALES     Kansas City   ⋯
   6 │  2020      1  Region B  NON-OPERATING_EXPENSES  HR        Cleveland
   7 │  2020      1  Region B  LIABILITIES             HR        Atlanta
   8 │  2020      1  Region B  NET_WORTH               SALES     Kansas City
  ⋮  │   ⋮      ⋮       ⋮                ⋮                ⋮            ⋮       ⋱
 414 │  2020      1  Region B  LIABILITIES             OTHERS    Richmond      ⋯
 415 │  2020      1  Region B  ASSETS                  HR        Chicago
 416 │  2020      1  Region B  OPERATING_EXPENSES      SALES     Chicago
 417 │  2020      1  Region B  STATISTICS              BUSINESS  St. Louis
 418 │  2020      1  Region B  LIABILITIES             BUSINESS  Atlanta       ⋯
 419 │  2020      1  Region B  STATISTICS              OTHERS    Boston
 420 │  2020      1  Region B  NET_WORTH               HR        New York
                                                   1 column and 405 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ########################
       ### Income Statement ###
       ########################
       
       select(gdf_plot[(
       				(gdf_plot.FISCAL_YEAR .== yr)
       				.&amp;
       				(gdf_plot.QTR .== qtr)
       				.&amp;
       				(gdf_plot.LEDGER .== ld)
       				.&amp;
       				(gdf_plot.OPER_UNIT .== rg)
       				.&amp;
       				(in.(gdf_plot.ACCOUNTS_CLASSIFICATION, Ref([&quot;ASSETS&quot;, &quot;LIABILITIES&quot;, &quot;REVENUE&quot;,&quot;NET_WORTH&quot;])))
       				),:],
       		:FISCAL_YEAR =&gt; :FY,
       		:QTR =&gt; :Qtr,
       		:OPER_UNIT =&gt; :Org,
       		:ACCOUNTS_CLASSIFICATION =&gt; :Accounts,
       		# :DEPT_CLASSIFICATION =&gt; :Dept,
       		# :LOCATION_CLASSIFICATION =&gt; :Region,
       		# :LOCATION_DESCR =&gt; :Loc,
       		:TOTAL =&gt; ByRow(numToCurrency) =&gt; :TOTAL)</code><code class="nohighlight hljs ansi" style="display:block;">240×5 DataFrame
 Row │ FY     Qtr    Org       Accounts     TOTAL
     │ Int64  Int64  String    String       String
─────┼────────────────────────────────────────────────────
   1 │  2020      1  Region B  ASSETS       USD 12106.87m
   2 │  2020      1  Region B  NET_WORTH    USD 11256.73m
   3 │  2020      1  Region B  LIABILITIES  USD 11418.78m
   4 │  2020      1  Region B  LIABILITIES  USD 11535.49m
   5 │  2020      1  Region B  NET_WORTH    USD 10471.89m
   6 │  2020      1  Region B  LIABILITIES  USD 13928.57m
   7 │  2020      1  Region B  ASSETS       USD 12534.86m
   8 │  2020      1  Region B  REVENUE      USD 11650.71m
  ⋮  │   ⋮      ⋮       ⋮           ⋮             ⋮
 234 │  2020      1  Region B  REVENUE      USD 12796.8m
 235 │  2020      1  Region B  ASSETS       USD 13533.96m
 236 │  2020      1  Region B  ASSETS       USD 13485.62m
 237 │  2020      1  Region B  LIABILITIES  USD 9736.96m
 238 │  2020      1  Region B  ASSETS       USD 11425.07m
 239 │  2020      1  Region B  LIABILITIES  USD 12871.33m
 240 │  2020      1  Region B  NET_WORTH    USD 10344.94m
                                          225 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ########################
       ##### CASH FLOW ########
       ########################
       
       select(gdf_plot[(
       				(gdf_plot.FISCAL_YEAR .== yr)
       				.&amp;
       				(gdf_plot.QTR .== qtr)
       				.&amp;
       				(gdf_plot.LEDGER .== ld)
       				.&amp;
       				(gdf_plot.OPER_UNIT .== rg)
       				.&amp;
       				(in.(gdf_plot.ACCOUNTS_CLASSIFICATION, Ref([&quot;NON-OPERATING_EXPENSES&quot;,&quot;OPERATING_EXPENSES&quot;	])))
       				),:],
       		:FISCAL_YEAR =&gt; :FY,
       		:QTR =&gt; :Qtr,
       		:OPER_UNIT =&gt; :Org,
       		:ACCOUNTS_CLASSIFICATION =&gt; :Accounts,
       		# :DEPT_CLASSIFICATION =&gt; :Dept,
       		# :LOCATION_CLASSIFICATION =&gt; :Region,
       		# :LOCATION_DESCR =&gt; :Loc,
       		:TOTAL =&gt; ByRow(numToCurrency) =&gt; :TOTAL)</code><code class="nohighlight hljs ansi" style="display:block;">120×5 DataFrame
 Row │ FY     Qtr    Org       Accounts                TOTAL
     │ Int64  Int64  String    String                  String
─────┼───────────────────────────────────────────────────────────────
   1 │  2020      1  Region B  NON-OPERATING_EXPENSES  USD 12683.17m
   2 │  2020      1  Region B  OPERATING_EXPENSES      USD 11459.46m
   3 │  2020      1  Region B  NON-OPERATING_EXPENSES  USD 12833.48m
   4 │  2020      1  Region B  OPERATING_EXPENSES      USD 11803.33m
   5 │  2020      1  Region B  OPERATING_EXPENSES      USD 12005.58m
   6 │  2020      1  Region B  OPERATING_EXPENSES      USD 10397.07m
   7 │  2020      1  Region B  NON-OPERATING_EXPENSES  USD 12783.47m
   8 │  2020      1  Region B  OPERATING_EXPENSES      USD 14042.55m
  ⋮  │   ⋮      ⋮       ⋮                ⋮                   ⋮
 114 │  2020      1  Region B  OPERATING_EXPENSES      USD 10917.51m
 115 │  2020      1  Region B  OPERATING_EXPENSES      USD 12302.46m
 116 │  2020      1  Region B  OPERATING_EXPENSES      USD 11697.56m
 117 │  2020      1  Region B  NON-OPERATING_EXPENSES  USD 11598.72m
 118 │  2020      1  Region B  NON-OPERATING_EXPENSES  USD 13028.84m
 119 │  2020      1  Region B  OPERATING_EXPENSES      USD 10533.04m
 120 │  2020      1  Region B  OPERATING_EXPENSES      USD 11722.16m
                                                     105 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ########################
       ##### Ledger Visual ####
       ########################
       
       plot_data = gdf_plot[(
       		(gdf_plot.FISCAL_YEAR .== yr_p)
       		.&amp;
       		(gdf_plot.LEDGER .== ld_p)
       		.&amp;
       		(gdf_plot.OPER_UNIT .== rg_p)
       		.&amp;
       		(gdf_plot.LOCATION_DESCR .== ldescr)
       		.&amp;
       		(gdf_plot.DEPT_CLASSIFICATION .== ddescr)
       		.&amp;
       		(gdf_plot.ACCOUNTS_CLASSIFICATION .== adescr))
       		, :];</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: DimensionMismatch(&quot;arrays could not be broadcast to a common size; got a dimension with lengths 12600 and 12&quot;)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# @df plot_data scatter(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;, label=&quot;$ld_p Total by $yr_p for $rg_p&quot;)
       	@df plot_data plot(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;,
       		label=[
       			&quot;$ld_p by $yr_p for $rg_p $ldescr $adescr $ddescr&quot;
       			],
       		lw=3)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: @df not defined
in expression starting at REPL[41]:1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; #################################
       ## Actual vs Budget Comparison ##
       #################################
       
       plot_data_a = gdf_plot[(
       		(gdf_plot.FISCAL_YEAR .== yr_p)
       		.&amp;
       		(gdf_plot.LEDGER .== &quot;Actuals&quot;)
       		.&amp;
       		(gdf_plot.OPER_UNIT .== rg_p)
       		.&amp;
       		(gdf_plot.LOCATION_DESCR .== ldescr)
       		.&amp;
       		(gdf_plot.DEPT_CLASSIFICATION .== ddescr)
       		.&amp;
       		(gdf_plot.ACCOUNTS_CLASSIFICATION .== adescr))
       		, :];</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: DimensionMismatch(&quot;arrays could not be broadcast to a common size; got a dimension with lengths 12600 and 12&quot;)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# @df plot_data scatter(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;, label=&quot;$ld_p Total by $yr_p for $rg_p&quot;)
       	plot_data_b = gdf_plot[(
       		(gdf_plot.FISCAL_YEAR .== yr_p)
       		.&amp;
       		(gdf_plot.LEDGER .== &quot;Budget&quot;)
       		.&amp;
       		(gdf_plot.OPER_UNIT .== rg_p)
       		.&amp;
       		(gdf_plot.LOCATION_DESCR .== ldescr)
       		.&amp;
       		(gdf_plot.DEPT_CLASSIFICATION .== ddescr)
       		.&amp;
       		(gdf_plot.ACCOUNTS_CLASSIFICATION .== adescr))
       		, :];</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: DimensionMismatch(&quot;arrays could not be broadcast to a common size; got a dimension with lengths 12600 and 12&quot;)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	# @df plot_data scatter(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;, label=&quot;$ld_p Total by $yr_p for $rg_p&quot;)
       	@df plot_data_a plot(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;,
       		label=[
       			&quot;Actuals by $yr_p for $rg_p $ldescr $adescr $ddescr&quot;
       			],
       		lw=3)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: @df not defined
in expression starting at REPL[44]:1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; 	@df plot_data_b plot!(:QTR, :TOTAL/10^8, title = &quot;Finance Ledger Data&quot;, xlabel=&quot;Quarter&quot;, ylabel=&quot;Total (in USD million)&quot;,
       		label=[
       			&quot;Budget by $yr_p for $rg_p $ldescr $adescr $ddescr&quot;
       			],
       		lw=3)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: LoadError: UndefVarError: @df not defined
in expression starting at REPL[45]:1</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../elt/">« ELT vs ETL</a><a class="docs-footer-nextpage" href="../plots/">Visualizations, Buttons, sliders, filters, n-D plots, plots vs graphs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.4 on <span class="colophon-date" title="Thursday 29 July 2021 21:56">Thursday 29 July 2021</span>. Using Julia version 1.6.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
